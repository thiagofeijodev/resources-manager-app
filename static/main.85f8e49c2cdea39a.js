(()=>{"use strict";var e,r,t,n={7226(e,r,t){var n=t(3712),o=t(538),l=t(1468),a=t(8562),i=t(1142),s=t(2174),u=t(7764);let d="/resources",c=`${d}/INCLUDE`,m=`${d}/CHANGE`,p=(0,u.VP)(c),h=(0,u.VP)(m),j=e=>{let r=localStorage.getItem(e);return r?JSON.parse(r)||{}:null},x=()=>{let e=j(d);return e||{}},b=(0,u.vy)(x(),e=>{e.addCase(p,(e,r)=>{let{payload:t}=r,n=x();return n[t.id]=t,localStorage.setItem(d,JSON.stringify(n)),n}).addCase(h,(e,r)=>{let{payload:t}=r,n=x();return n[t.resourceId]&&(n[t.resourceId].amount+=t.amount),localStorage.setItem(d,JSON.stringify(n)),n})}),g=e=>e.resource||{},v="/history",f=`${v}/INCLUDE`,y=(0,u.VP)(f),S=()=>{let e=j(v);return e||[]},C=(0,u.vy)(S(),e=>{e.addCase(y,(e,r)=>{let{payload:t}=r,n=[...S(),t];return localStorage.setItem(v,JSON.stringify(n)),n})}),O=e=>e.history||[],w=(0,u.U1)({reducer:{resource:b,history:C}});var I=t(8780),k=t(4355),L=t(2284),N=t(96),R=t(7207),B=t(4746);let E=(0,i.styled)("div",{display:"flex",justifyContent:"space-between",alignItems:"baseline"});var M=t(9088);function P(e){let{items:r,onSelect:t,Component:o}=e,l=I.forwardRef((e,r)=>(0,n.jsx)(o,{...e,ref:r,onSelect:t}));return l.displayName="ListItemOverride",(0,n.jsx)(M.Menu,{items:r,overrides:{Option:{props:{overrides:{ListItem:{component:l}}}}}})}function F(e){let{title:r,items:t,Viewer:o,Item:l}=e,[a,i]=I.useState(null);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(R.HeadingLevel,{children:(0,n.jsxs)(E,{children:[(0,n.jsx)(R.Heading,{children:r}),(0,n.jsx)(k.Button,{shape:k.SHAPE.circle,onClick:()=>i({}),children:(0,n.jsx)(B.Plus,{})})]})}),(0,n.jsx)(P,{items:t,onSelect:e=>{let{item:r}=e;return i(r)},Component:l}),(0,n.jsx)(N.Modal,{onClose:()=>i(null),closeable:!0,isOpen:!!a,animate:!0,autoFocus:!0,size:N.SIZE.full,role:N.ROLE.dialog,children:(0,n.jsx)(o,{item:a,onClose:()=>i(null)})})]})}t(4423);var T=t(9250);function A(){let[e,r]=I.useState([]);return(0,n.jsx)(T.FileUploader,{overrides:{ContentMessage:()=>"Load database..."},accept:[".json"],maxSize:1e6,fileRows:e,setFileRows:e=>r(e),processFileOnDrop:e=>new Promise((r,t)=>{let n=new FileReader;n.onload=async()=>{let t=JSON.parse(n.result);for(let e in t)[v,d].includes(e)&&localStorage.setItem(e,t[e]);return r({name:e.name,data:n.result}),Promise.resolve()},n.onerror=e=>{console.log("Error reading file:",e),t(e)},n.readAsText(e)})})}var D=t(9923);let V=e=>{var r;let{ref:t,...o}=e,a=(0,l.d4)(g),i=(o.item.resource||[]).map(e=>{let{id:r}=e;return r}).join();return(0,n.jsx)(D.MenuAdapter,{...o,onClick:()=>o.onSelect(o),ref:t,endEnhancer:()=>(0,n.jsx)(B.ChevronRight,{}),children:(0,n.jsx)(D.ListItemLabel,{description:`Total amount: ${o.item.amount}`,children:(null==(r=a[i])?void 0:r.name)||"Not fount"})})},H=e=>{let{ref:r,...t}=e;return(0,n.jsx)(D.MenuAdapter,{...t,onClick:()=>t.onSelect(t),ref:r,endEnhancer:()=>(0,n.jsx)(B.ChevronRight,{}),children:(0,n.jsx)(D.ListItemLabel,{description:`Total amount: ${t.item.amount}`,children:t.item.name})})};var U=t(7104),$=t(3893),_=t(3211),K=t(4749);function J(e){let{item:r,onClose:t}=e,o=(0,l.d4)(g),a=(0,l.wA)(),i=Object.keys(r||{}).length>0,s=i?r:{resource:[],amount:0};return(0,n.jsx)(U.l1,{initialValues:s,validate:e=>{let r={};return e.resource||(r.resource="Required"),e.amount||(r.amount="Required"),r},onSubmit:(e,r)=>{let{setSubmitting:n}=r,o=e.resource.map(e=>{let{id:r}=e;return r}).join(),l={id:new Date().toISOString(),resourceId:o,...e};a(y(l)),a(h(l)),n(!1),t()},children:e=>{let{values:r,errors:l,touched:a,handleChange:s,handleBlur:u,setFieldValue:d,handleSubmit:c,isSubmitting:m}=e;return(0,n.jsxs)("form",{onSubmit:c,children:[(0,n.jsx)(N.ModalHeader,{children:i?"View":"New"}),(0,n.jsxs)(N.ModalBody,{children:[(0,n.jsx)(K.FormControl,{label:"Resouce",children:(0,n.jsx)(_.Select,{options:Object.values(o),placeholder:"Select resource",name:"resource",labelKey:"name",valueKey:"id",onChange:e=>{let{value:r}=e;return d("resource",r)},error:l.resource&&a.resource&&l.resource,onBlur:u,value:r.resource,disabled:i})}),(0,n.jsx)(K.FormControl,{label:"Amount",children:(0,n.jsx)($.Input,{type:"number",name:"amount",error:l.amount&&a.amount&&l.amount,onChange:s,onBlur:u,value:r.amount,disabled:i})}),i&&(0,n.jsx)(K.FormControl,{label:"Created at",children:(0,n.jsx)($.Input,{type:"text",name:"id",value:new Date(r.id).toLocaleString(),disabled:i})})]}),(0,n.jsxs)(N.ModalFooter,{children:[(0,n.jsx)(k.Button,{type:"button",kind:k.KIND.tertiary,disabled:m,isLoading:m,onClick:t,children:"Cancel"}),!i&&(0,n.jsx)(k.Button,{type:"submit",disabled:m,isLoading:m,onClick:c,children:"Save"})]})]})}})}function q(e){let{item:r,onClose:t}=e,o=(0,l.wA)(),a=Object.keys(r||{}).length>0,i=a?r:{name:"",amount:""};return(0,n.jsx)(U.l1,{initialValues:i,validate:e=>{let r={};return e.name||(r.name="Required"),e.amount||(r.amount="Required"),r},onSubmit:(e,r)=>{let{setSubmitting:n}=r;o(p({id:new Date().toISOString(),...e})),n(!1),t()},children:e=>{let{values:r,errors:o,touched:l,handleChange:i,handleBlur:s,handleSubmit:u,isSubmitting:d}=e;return(0,n.jsxs)("form",{onSubmit:u,children:[(0,n.jsx)(N.ModalHeader,{children:a?"View":"New"}),(0,n.jsxs)(N.ModalBody,{children:[(0,n.jsx)(K.FormControl,{label:"Name",children:(0,n.jsx)($.Input,{type:"text",name:"name",error:o.name&&l.name&&o.name,onChange:i,onBlur:s,value:r.name})}),(0,n.jsx)(K.FormControl,{label:"Amount",children:(0,n.jsx)($.Input,{type:"number",name:"amount",error:o.amount&&l.amount&&o.amount,onChange:i,onBlur:s,value:r.amount,disabled:a})}),a&&(0,n.jsx)(K.FormControl,{label:"Created at",children:(0,n.jsx)($.Input,{type:"text",name:"id",value:new Date(r.id).toLocaleString(),disabled:a})})]}),(0,n.jsxs)(N.ModalFooter,{children:[(0,n.jsx)(k.Button,{kind:k.KIND.tertiary,disabled:d,isLoading:d,onClick:t,children:"Cancel"}),(0,n.jsx)(k.Button,{type:"submit",disabled:d,isLoading:d,onClick:u,children:"Save"})]})]})}})}function z(){let[e,r]=I.useState("0"),t=(0,l.d4)(g),o=(0,l.d4)(O);return(0,n.jsxs)(L.Tabs,{activeKey:e,onChange:e=>{let{activeKey:t}=e;return r(t)},children:[(0,n.jsx)(L.Tab,{title:"Resources",children:(0,n.jsx)(F,{title:"Resources",items:Object.values(t),Viewer:q,Item:H})}),(0,n.jsx)(L.Tab,{title:"Historic",children:(0,n.jsx)(F,{title:"Historic",items:o||[],Viewer:J,Item:V})}),(0,n.jsxs)(L.Tab,{title:"Setting",children:[(0,n.jsx)(A,{}),(0,n.jsx)("br",{}),(0,n.jsx)(k.Button,{onClick:()=>{var e;let r,t;e=JSON.stringify(Object.keys(localStorage).reduce((e,r)=>({...e,[r]:localStorage.getItem(r)}),{})),r=document.createElement("a"),t=new Blob([e],{type:"text/plain"}),r.href=URL.createObjectURL(t),r.download="database.json",r.click()},children:"Backup"})]})]})}let W=new a.A,G=document.getElementById("root");(0,o.createRoot)(G).render((0,n.jsx)(()=>(0,n.jsx)(i.Provider,{value:W,children:(0,n.jsx)(s.BaseProvider,{theme:s.LightTheme,children:(0,n.jsx)(l.Kq,{store:w,children:(0,n.jsx)(z,{})})})}),{})),"serviceWorker"in navigator&&navigator.serviceWorker.register("service-worker.js")}},o={};function l(e){var r=o[e];if(void 0!==r)return r.exports;var t=o[e]={id:e,loaded:!1,exports:{}};return n[e].call(t.exports,t,t.exports,l),t.loaded=!0,t.exports}l.m=n,l.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return l.d(r,{a:r}),r},l.d=(e,r)=>{for(var t in r)l.o(r,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},l.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),l.k=e=>""+e+".css",l.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}})(),l.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a=[],l.O=(e,r,t,n)=>{if(r){n=n||0;for(var o=a.length;o>0&&a[o-1][2]>n;o--)a[o]=a[o-1];a[o]=[r,t,n];return}for(var i=1/0,o=0;o<a.length;o++){for(var[r,t,n]=a[o],s=!0,u=0;u<r.length;u++)(!1&n||i>=n)&&Object.keys(l.O).every(e=>l.O[e](r[u]))?r.splice(u--,1):(s=!1,n<i&&(i=n));if(s){a.splice(o--,1);var d=t();void 0!==d&&(e=d)}}return e},l.rv=()=>"1.6.8",l.g.importScripts&&(i=l.g.location+"");var a,i,s=l.g.document;if(!i&&s&&(s.currentScript&&"SCRIPT"===s.currentScript.tagName.toUpperCase()&&(i=s.currentScript.src),!i)){var u=s.getElementsByTagName("script");if(u.length)for(var d=u.length-1;d>-1&&(!i||!/^http(s?):/.test(i));)i=u[d--].src}if(!i)throw Error("Automatic publicPath is not supported in this browser");l.p=(i=i.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"))+"../",e={889:0},l.O.j=r=>0===e[r],r=(r,t)=>{var n,o,[a,i,s]=t,u=0;if(a.some(r=>0!==e[r])){for(n in i)l.o(i,n)&&(l.m[n]=i[n]);if(s)var d=s(l)}for(r&&r(t);u<a.length;u++)o=a[u],l.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return l.O(d)},(t=self.webpackChunkresources_manager_app=self.webpackChunkresources_manager_app||[]).forEach(r.bind(null,0)),t.push=r.bind(null,t.push.bind(t)),l.ruid="bundler=rspack@1.6.8";var c=l.O(void 0,["824"],()=>l(7226));c=l.O(c)})();